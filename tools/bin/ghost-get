#!/usr/bin/env bash
set -euo pipefail

# Get a Ghost CMS post by ID.
#
# Usage:
#   ghost-get <post_id>
#
# Requires: GHOST_URL, GHOST_ADMIN_API_KEY in environment or .env

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/../.." && pwd)"

if [ -f "$SCRIPT_DIR/.env" ]; then
    set -a; source "$SCRIPT_DIR/.env"; set +a
fi

: "${GHOST_URL:?GHOST_URL not set}"
: "${GHOST_ADMIN_API_KEY:?GHOST_ADMIN_API_KEY not set}"

PYTHON="${SCRIPT_DIR}/venv/bin/python"
CLIENT="${SCRIPT_DIR}/src/ghost_client.py"

POST_ID="${1:?Usage: ghost-get <post_id>}"

exec "$PYTHON" "$CLIENT" get "$POST_ID"
